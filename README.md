# 🐶 PetWithU
<p align="center"><img src="https://user-images.githubusercontent.com/53294075/218286832-8953f862-d778-4ba3-a01d-e2e3fd9d54dd.png" width = "400px"></p>

Hi, we are team 'PetWithU'! 🤗
- 'PetWithU" is the final project team name and our service name consisting of students from the 41th Wecode Coding Boot Camp.
- It is an application that provides community services and sells pet products to users who have pets.
- We clone-coded the '[Today's house](https://ohou.se/)' web site.
    - 'Today's house' is an interior platform service launched by a Korean startup that provides all the services for interior design, from online housewarming contents to stores and expert construction services.

🖥️ [Demo video](https://youtu.be/Tx5LHiD54os)

<br>

## 🐩 Our Service
* We use the social login to simplify the membership process to increase user accessibility and convenience.
* When user creates a feed post, user can tag products that purchased on the site so that other users can access product information.
* Users can view the promenade filtered by region, so they can quickly find local information on the promenade.
    * We use the map API to mark the location of the promenade as coordinates on the map.
* Users can view a lot of collected posts on a single page.

<br>

## 🗓 Period
2023/01/30 ~ 2023/02/10 (About 2 weeks)

<br>

## 👥 Team Members
### Back-End

👑 [Judy Choi (Product Manager)](https://github.com/Judy-Choi)

### Front-End

👑 [SY Kang (Project Manager)](https://github.com/seoyunlefleuve), [KM Bae](https://github.com/bjy6439), [NH Kwon](https://github.com/skgusskgusgg)

<br>

## 💻 Tech Stack
Frond-End
<img src="https://img.shields.io/badge/Javscript-F7DF1E?style=flat&amp;logo=javascript&amp;logoColor=white">
<img src="https://img.shields.io/badge/React.js-61DAFB?style=flat&amp;logo=React&amp;logoColor=white">
<img src="https://img.shields.io/badge/React Router-CA4245?style=flat&amp;logo=ReactRouter&amp;logoColor=white">
<img src="https://img.shields.io/badge/styled-components-DB7093?style=flat&amp;logo=styled-components-DB7093&amp;logoColor=white">

Back-End
<img src="https://img.shields.io/badge/Node.js-339933?style=flat&amp;logo=Node.js&amp;logoColor=white">
<img src="https://img.shields.io/badge/Nodemon-76D04B?style=flat&amp;logo=Nodemon&amp;logoColor=white">
<img src="https://img.shields.io/badge/Express-000000?style=flat&amp;logo=Express&amp;logoColor=white">
<img src="https://img.shields.io/badge/MySQL-4479A1?style=flat&amp;logo=MySQL&amp;logoColor=white">
<img src="https://img.shields.io/badge/JWT-CC6699?style=flat&amp;logo=JSON&amp;logoColor=white">
<img src="https://img.shields.io/badge/Dbmate-009DC7?style=flat&amp;logo=Bcrypt&amp;logoColor=white">
<img src="https://img.shields.io/badge/Bcrypt-CA424?style=flat&amp;logo=Bcrypt&amp;logoColor=white">

Common
<img src="https://img.shields.io/badge/Git-F05032?style=flat&amp;logo=Git&amp;logoColor=white">
<img src="https://img.shields.io/badge/GitHub-181717?style=flat&amp;logo=GitHub&amp;logoColor=white">
<img src="https://img.shields.io/badge/Prettier-F7B93E?style=flat&amp;logo=prettier&amp;logoColor=white">
<img src="https://img.shields.io/badge/RestfulAPI-F7533E?style=flat&amp;logo=RestfulAPII&amp;logoColor=white">
<img src="https://img.shields.io/badge/VSCode-007ACC?style=flat&amp;logo=Visual Studio Code&amp;logoColor=white">
<img src="https://img.shields.io/badge/Postman-FF6C37?style=flat&amp;logo=Postman Code&amp;logoColor=white">
<img src="https://img.shields.io/badge/AWS-232F3E?style=flat&amp;logo=AWS Code&amp;logoColor=white">
<img src="https://img.shields.io/badge/AWS_EC2-FF9900?style=flat&amp;logo=AWS_EC2 Code&amp;logoColor=white">
<img src="https://img.shields.io/badge/AWS_RDS-527FFF?style=flat&amp;logo=AWS_RDS Code&amp;logoColor=white">
<img src="https://img.shields.io/badge/AWS_S3-569A31?style=flat&amp;logo=AWS_S3 Code&amp;logoColor=white">
<img src="https://img.shields.io/badge/Kakao_API-FFCD00?style=flat&amp;logo=Kakaotalk Code&amp;logoColor=white">

Communication
<img src="https://img.shields.io/badge/Slack-4A154B?style=flat&amp;logo=Slack&amp;logoColor=white">
<img src="https://img.shields.io/badge/Trello-0052CC?style=flat&amp;logo=Trello&amp;logoColor=white">
<img src="https://img.shields.io/badge/Notion-000000?style=flat&amp;logo=Notion&amp;logoColor=white">

<br>

## 🖼️ Example

<details>
    <summary>Show Images</summary>
    
!Images will be changed!
    


| Page | Screenshot | Developer |
| --- | --- | --- |
| DB Architecture/<br>Migration | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218289356-eff87768-d75e-4eee-aaa6-018ba378cd1b.png" width = "600px"></p><br>[Detail LINK](https://github.com/wecode-bootcamp-korea/41-2nd-PetWithU-backend/issues/5) | [BE] Judy Choi |
| Main<br>Nav Bar<br>Footer | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218318656-9fd2e054-85cc-4b21-b408-4e02aa701cea.png" width = "400px"></p> | [FE] KM Bae <br> [BE] Judy Choi |
| Kakao Login | <p align="center"><video src="https://user-images.githubusercontent.com/53294075/218317950-ed1901e7-c407-46fb-8ab4-2c0ce5aa0889.mov" width = "400px"></video></p> | [FE] KM Bae <br> [BE] Judy Choi |
| Feed Main | <p align="center"><video src="https://user-images.githubusercontent.com/53294075/218318417-6f7905c4-79b8-4189-9039-b74448c77f1e.mov" width = "400px"></video></p> | [FE] KM Bae <br> [BE] Judy Choi |
| Feed Detail | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218318656-9fd2e054-85cc-4b21-b408-4e02aa701cea.png" width = "400px"></p> | [FE] NH Kwon <br> [BE] Judy Choi |
| Feed<br>Collection | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218318656-9fd2e054-85cc-4b21-b408-4e02aa701cea.png" width = "400px"></p> | [FE] KM Bae <br> [BE] Judy Choi |
| Feed<br>Create | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218318751-77832b5f-7fcc-4dff-8812-6f60e7dc3a52.png" width = "400px"></p> | [FE] NH Kwon <br> [BE] Judy Choi |
| Search<br>Products | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218318797-f28cea71-fff5-40cf-a519-34a46c763052.png" width = "400px"></p> | [FE] KM Bae <br> [BE] Judy Choi |
| Product<br>detail | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218318852-d5d7c057-b2b5-4e75-9f2d-fdc41e526791.png" width = "400px"></p> | [FE] NH Kwon <br> [BE] Judy Choi |
| Promenade<br>Main | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218318951-24fb9ded-472f-4d3a-9755-0efb4e669960.png" width = "400px"><br><img src="https://user-images.githubusercontent.com/53294075/218319054-81b68955-4a06-4bf4-9ce6-ab55712eaeaa.png" width = "400px"></p> | [FE] SY Kang <br> [BE] Judy Choi |
| Promenade<br>Detail | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218318977-84391381-218b-4348-9f12-10e5101cb1af.png" width = "400px"></p> | [FE] SY Kang <br> [BE] Judy Choi |
| Promenade<br>Collection | <p align="center"><img src="https://user-images.githubusercontent.com/53294075/218319020-56fc3d6f-4c59-4039-85b2-dce1944f5080.png" width = "400px"></p> | [FE] SY Kang <br> [BE] Judy Choi |
| Carts | FE to be continued..  | [FE] NH Kwon <br> [BE] Judy Choi |
    
</details>

<br>

## 📑 API Documentation
[Postman Link](https://documenter.getpostman.com/view/24998473/2s935oLPdR)

<br>

## 🛠️ Dev Details

<details>
    <summary>Details</summary>
    
### 🗄️ Server & DataBase
- Set DB on AWS RDS to enable FE and users to access DB at any time.

### 👨‍👩‍👧‍👦 Users
#### Login / Sign Up
- Social login and sign in with Kakao SDK for JavaScript
- After login, use JWT instead of password for user authentication/authorization (to improve security)
- Encrypt user's password using Bcrypt and save it to DB
    - Manage user's account information more securely

#### Follow / Following
- Follow / Following between users

### 🦴 Products
#### Main page
- Today's products : Sort each category's products in descending order by sales volume and extract only the top 1 product 
- All products : Sort all products in descending order by sales volume

#### Detail page
- View the details of the product

### 🖼️ Feed
- Authorization after user authentication by verifying the JWT of the signed-in user before all APIs are runned.

#### Main Page
- Efficient request from FE by using query parameters
- Pagination
  - Request query를 이용하여 FE에서 요청하는 카테고리 페이지 정보를 효율적으로 요청받음
  - In order to support Page Nation of FE, default 9 datas (per page) are extracted from DB and provided to FE.
It also reduces traffic overload and execution time (prevent delivering too much data at once)
- 로그인한 사용자가 팔로우하는 사용자가 작성한 게시글만 조회
    1. 팔로우하는 사용자 ID 를 얻어서
    2. 해당 ID가 작성한 게시글을 최신 순으로 pagination 크기만큼 정렬
- Flag 를 사용하여 Feed Main 에 필요한 정보만 리턴되도록 하여 효율성 증대
- 좋아요 / 스크랩 / 댓글 조회 지원
    - 좋아요 및 스크랩 버튼 클릭 시 Toggle 형태로 FE 에서 간편하게 상태 변경 결과를 알 수 있게 함
    
#### Detail Page
- 좋아요 / 스크랩
    - 좋아요 및 스크랩 버튼 클릭 시 Toggle 형태로 FE 에서 간편하게 상태 변경 결과를 알 수 있게 함
- 댓글 조회 / 등록 / 삭제 지원
    - 댓글 생성 시 사용자 정보를 FE 에 리턴하여 작성자 정보를 알 수 있게 함.
    
#### Collection(Scraped posts) Page
- 사용자가 스크랩한 게시글을 한 페이지에서 조회할 수 있도록 하여 사용자 편의성 증대

### 📝 Feed (Special Options)
#### 글쓰기
- Bulk INSERT
    - Bulk Insert 를 이용하여 많은 양의 데이터를 하나의 INSERT 쿼리로 DB에 저장
        - 수행시간 최소화, 하나의 쿼리만을 사용하므로 효율성 증대
- Multer & AWS S3
    - 이미지 업로드를 위해 Multer 미들웨어 사용
        1. FE로부터 이미지 파일을 전달받아 S3에 저장
        2. 이미지 S3 url을 DB 에 저장
#### 상품 검색
- FE로부터 검색할 키워드를 request 쿼리로 전달받아 DB에서 검색
    - 키워드를 포함하는 상품정보를 판매량 순으로 정렬하여 최대 10개 리턴
    
### 🏞️ Promenade
모든 API가 수행되기 전에 로그인한 사용자의 JWT 를 검증하여 사용자 인증 후 인가.   
지도 API (카카오맵) 을 이용한 산책로 위치 표시

#### Main Page
- Request query 를 이용하여 FE에서 요청하는 페이지 정보를 효율적으로 요청받음
- 카테고리(시, 행정구) 별 조회 시 Query 재사용성 증대
  - 카테고리별(시, 행정구) 게시물 조회 시 비슷한 SQL 쿼리가 반복하여 사용되는 것을 최소화하고자 중복되는 쿼리는 defaultQuery 문자열로 한 번만 선언한 뒤 각 페이지에서 필요한 추가 쿼리를 덧붙여 사용
- Pagination 지원
  - Request query를 이용하여 FE에서 요청하는 카테고리 페이지 정보를 효율적으로 요청받음
  - FE 의 Pagination 을 효과적으로 지원하기 위해 DB에서 데이터 추출 시 Pagination 단위만큼 데이터를 추출하여 FE에 제공
  - 한번에 너무 많은 데이터를 전달할 경우 발생하는 트래픽 과부하 및 수행 시간을 줄이는 효과도 있음.
- Flag 를 사용하여 산책로 Main 에 필요한 정보만 리턴되도록 하여 효율성 증대
- 좋아요 / 스크랩 / 댓글 조회 지원
    - 좋아요 및 스크랩 버튼 클릭 시 Toggle 형태로 FE 에서 간편하게 상태 변경 결과를 알 수 있게 함

#### Detail Page
- FE 에서 카카오맵 API를 사용하기 위해 필요한 정보 저장 (장소명, 장소 ID, 위도, 경도 저장)
- 좋아요 / 스크랩
    - 좋아요 및 스크랩 버튼 클릭 시 Toggle 형태로 FE 에서 간편하게 상태 변경 결과를 알 수 있게 함
- 댓글 조회 / 등록 / 삭제 지원
    - 댓글 생성 시 사용자 정보를 FE 에 리턴하여 작성자 정보를 알 수 있게 함.
    
#### Collection(Scraped posts) Page
- 사용자가 스크랩한 게시글을 한 페이지에서 조회할 수 있도록 하여 사용자 편의성 증대
- 스크랩한 게시글의 지도 정보(장소 좌표)를 모두 리턴하여 하나의 지도 위에 모든 장소 좌표가 표기될 수 있도록 지원. 사용자 편의성 증대.

### 🛒 Carts
모든 API가 수행되기 전에 로그인한 사용자의 JWT 를 검증하여 사용자 인증 후 인가.

#### 장바구니 추가/수량 변경
- UPSERT 구문을 사용하여 하나의 API 및 하나의 쿼리 내에서 INSERT와 UPDATE가 동시에 이루어지도록 구현

#### 장바구니 조회 / 삭제
- INNER JOIN 쿼리를 조합하여 JWT 단 하나만으로 사용자 장바구니의 모든 정보를 조회할 수 있도록 구현 (정보 노출 최소화 및 보안 강화)
- Bulk Delete 를 이용하여 여러 개의 장바구니 삭제를 하나의 Query 로 수행

</details>

<br>

## 💡 Improved Works
<details>
    <summary>Read more</summary>
### JWT is too weak...
- 💡 Social login & sign in with Kakao SDK for JavaScript
    - Improve both security and user convenience

### Our DB are in each member's local...
- Could not share same DB & Could not test our module in the same environment
    - 💡 All team members use one DB in any time with AWS RDS
    - 💡 Share one DB when uploading an image file with AWS S3
    
### Inefficient FE-BE connection test
- Can run only one server at the same time
  - 💡 We changed port number of test branch
    
- We had to wait until our supervisor feedbacks to the pull request and merges to the main branch
    
- There are many sub branches. So when we had some module test, we had to checkout sub branches often
  - 💡 We made test branch & merge all sub branches to the test branch
    
- If the main branch and test branch are run at the same time, the debugger is attached to the test branch process instead of the main branch (can't debug).
- Switching test branches makes interrupt, also it's annoying to integrate the code.
  - 💡 Create an AWS EC2 instance and pull source code from the GitHub repository using git
    - Real-time testing is available
    
### API Documentation
- I don't know what API I developed because I developed more than 20 😂
  - 💡 Let's try API documentation tool
    - Create Postman Team Workspace and invite team members
    - Check the updated API information in Postman
    
### Spaghetti code 🍝
- Too many bugs 🐞
    - 💡 TDD (ex : Jest)
    - 💡 When reporting issues from FE to BE, report error status code and error message.
        - It is helpful to catch issue quickly
    
</details>

<br>

## 🤔 Future Works (Trouble Shooting)

<details>
    <summary>Read more</summary>
 
### In the Dao Layer, Transaction(Query Runner) often works abnormally.
- ☠️ The reason is unknown and the problem is not resolved... 😂
   
### When we tried VScode SSH remote debugging to AWS EC2 server, server responded very late.
- ☠️ The reason is unknown...
    
### API Documentation Tool
- Malform Header error is occured when Multer tested with Postman
  - 💡 Postman's own bug so we used Insomenia instead.
- Is the Postman the best?
    - 💡 We can try other API documentation tool than Postman / Insomenia
        - ex) Swagger
    


</details>
